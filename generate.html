<!DOCTYPE html>
<html>
<head>
	<title></title>
	<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
	<style type="text/css">
		.line {
		  fill: none;
		  stroke: steelblue;
		  stroke-width: 1.5px;
		}

		.slider .handle {
		  fill: steelblue;
	
		  stroke: #fff;
		  stroke-opacity: .5;
		  stroke-width: 1.25px;
		  cursor: crosshair;
		}

	</style>

</head>
<body>
<div id="graph"></div>

<script type="text/javascript">
var height = 600;
var width = 800;
var padding = 50;
var data; 
var paths = [];
var points = [];

var lastRank = 100;

var xScale, yScale, rScale;

var brush, current;

//visual elements
var slider, handle;


var svg = d3.select("#graph").append("svg")
.attr("width", width)
.attr("height", height);

d3.json("testCases.json", function(error, json){
	if (error) return console.warn(error);

	console.log(json);
	data = json.data;

	data.forEach(function(datum){
		datum.id = +datum.id;
		datum.ticks.forEach(function(tick){
			tick.time = new Date(tick.time).getTime();
			tick.stars = +tick.stars;
			tick.rank = +tick.rank;
		});
	});

	var start = end = data[0].ticks[0].time;
	console.log(data);
	data[0].ticks.forEach(function(d){
		if (d.time < start) start = d.time;
		if (d.time > end) end = d.time;
	});

	xScale = d3.time.scale().domain([start, end]).range([padding, width-padding]).clamp(true);
	yScale = d3.scale.linear().domain([lastRank,1]).range([height-padding, padding]);
	rScale = d3.scale.linear().domain([0,100]).range([3, 30]);

	var line = d3.svg.line()
	.x(function(d){return xScale(d.time);})
	.y(function(d){return yScale(d.rank);});

	data.forEach(function(datum){
		var path = svg.datum(datum.ticks).append("path").attr("class","line").attr("d", line);
		var point = svg.append("circle").attr("class", "point").attr("r",rScale(0));
		paths.push(path);
		points.push(point);

	});
});


function highlight(){
	
}

	
/*brush = d3.svg.brush()
    .x(xScale)
    .extent([0,0])
    .on("brush", brushed);


slider = svg.append("g")
	.attr("class", "brush")
	.call(brush);

slider.selectAll(".extent,.resize")
    .remove();

slider.select(".background")
    .attr("height", padding)
    .attr("width", width-2*padding)
    .attr("x", padding)
    .attr("y", height-padding);

var handle = slider.append("circle")
    .attr("class", "handle")
    .attr("transform", "translate("+padding+"," + (height - padding/2) + ")")
    .attr("r", 9);

slider.call(brush.event);
function brushed() {
	console.log('reached');
   var value = brush.extent()[0];
   console.log(value);
  if (d3.event.sourceEvent) { // not a programmatic event
    value = x.invert(d3.mouse(this)[0]);
    brush.extent([value, value]);
  }
  handle.attr("cx", x(value));
  d3.select("body").style("background-color", d3.hsl(value, .8, .8));
}*/
</script>
</body>
</html>